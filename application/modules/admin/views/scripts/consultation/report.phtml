<section class="section-header">
    <div class="container">

        <h1 class="section-header-title"><?=$this->escape($this->consultation->titl);?></h1>
        <h2 class="section-header-subtitle"><?=$this->escape($this->consultation->titl_sub);?></h2>

        <?=$this->consultationTabs($this->consultation->kid, 'consultation');?>

    </div>
</section>
<section class="section-content">
    <div class="container">
        <div class="row">
            <div class="sidebar offset-bottom-large-sm-max">

                <?=$this->consultationNavigation($this->consultation, 'stats');?>

            </div>
            <div class="content">

                <h2><?=$this->translate('Statistics');?></h2>
                <p>
                    <b>
                        <a href="<?php echo $this->url(array(
                            'controller' => 'input',
                            'action' => 'userlist'
                            )); ?>"
                          title="<?=$this->translate('All Contributors');?>">
                            <?=$this->translate('Number of contributors in current consultation');?>:
                            <?php echo $this->nrParticipants; ?>
                        </a>
                    </b>
                    <br/><?=$this->translate('Accumulated number of individuals and groups, even if they contributed in several sessions in this particular consultation');?>
                </p>
                <p>
                    <b><?=$this->translate('All contributions in the contribution period');?>: <?php echo $this->nrInputs; ?></b>
                    <br/>&raquo; <?=$this->translate('of which the contributions that were confirmed');?>: <?php echo $this->nrInputsConfirmed; ?>
                    <br/>&raquo; <?=$this->translate('of which remained unconfirmed or anonymous');?>: <?php echo $this->nrInputsUnconfirmed; ?>
                    <br/>&raquo; <?=$this->translate('of which were blocked by organisers');?>: <?php echo $this->nrInputsBlocked; ?>
                </p>
                <p>
                    <b><?=$this->translate('Contributions that were available to vote');?>: <?php echo $this->nrInputsVoting; ?></b>
                    <br />(<?=$this->translate('partly copy->edited, merged or splitted by organisers due to overlapping contents');?>)
                </p>

                <hr />

                <?php foreach ($this->questions as $question): ?>
                    <p>
                        <b>
                            <a href="<?php echo $this->url(array(
                                'controller' => 'input',
                                'action' => 'index',
                                'qid' => $question['qi']
                                )); ?>"
                              title="<?=$this->translate('See Contribution');?>"
                            >
                                <?php echo $question['nr']; ?> <?php echo $question['q']; ?>
                            </a>
                        </b>
                        <br /><?=$this->translate('Number of contributions');?>: <?php echo $question['nrInputsConfirmed']; ?>
                        (<?=$this->translate('only confirmed ones');?>)
                        <br /><?=$this->translate('Number of contributions for voting');?>: <?php echo $question['nrInputsVoting']; ?>
                        (<?=$this->translate('partly copy->edited, merged or splitted by organisers due to overlapping contents');?>)
                    </p>
                <?php endforeach; ?>

                <hr />

                <p>
                    <a href="<?php echo $this->url(array(
                        'controller' => 'voting',
                        'action' => 'participants'
                        )); ?>"
                       title="<?=$this->translate('Absolute number of votes');?>"
                    >
                        <b><?=$this->translate('Absolute number of votes');?>: <?php echo $this->votingCountIndiv; ?></b>
                    </a>
                    <br/>(<?=$this->translate('without taking into account different voting weights');?>)
                </p>

                <p>
                    <a href="<?php echo $this->url(array(
                        'controller' => 'voting',
                        'action' => 'index'
                        )); ?>"
                      title="<?=$this->translate('Groups that have voting rights and number of actually participating ones');?>"
                    >
                        <b><?=$this->translate('Groups that have voting rights and number of actually participating ones');?></b>
                    </a>
                </p>
                <table>
                    <?php foreach ($this->weightCounts as $weight): ?>
                        <tr>
                            <th scope="row">
                                <?php switch ($weight['vt_weight']) {
                                    case 0:
                                        echo $this->translate('Test accounts');
                                        break;
                                    case 1:
                                        echo $this->translate('Individuals');
                                        break;
                                    default:
                                        echo $this->translate('Group weight') . ' ' . $weight["vt_weight"];
                                        break;
                                } ?>:
                            </th>
                            <td>
                                <?php echo $weight['participating_count']; ?> / <?php echo $weight['weight_count']; ?>
                            </td>
                        </tr>
                    <?php endforeach; ?>
                </table>

            </div>
        </div>
    </div>
</section>
