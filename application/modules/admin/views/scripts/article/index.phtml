<?php
/**
 * index
 *
 * @description   Articles
 * @author        Markus Hackel
 */
?>
<h1><?php echo !empty($this->consultation) ? $this->consultation['titl'] : 'Allgemeine Seiten';?></h1>
<?php
echo $this->consultationNavigation('Artikel');
?>
<h2>Artikelübersicht</h2>
<p><a href="<?php echo $this->url(array(
  'action' => 'create',
  'kid' => isset($this->consultation) ? $this->consultation['kid'] : 0
));?>">Neuer Artikel</a></p>
<table class="full">
  <tr>
    <th>Seite</th>
    <th>Inhalt</th>
    <th>Aktionen</th>
  </tr>
<?php foreach ($this->articles as $article):?>
  <tr>
    <td><?php echo $article['desc']; ?></td>
    <td><?php echo substr(strip_tags($article['artcl']), 0, 200); ?></td>
    <td><a href="<?php echo $this->url(array(
  'action' => 'edit',
  'kid' => $this->consultation['kid'],
  'aid' => $article['art_id']
    ));?>">Bearbeiten</a>
    &nbsp;
    <a href="<?php echo $this->url(array(
  'action' => 'delete',
  'kid' => $this->consultation['kid'],
  'aid' => $article['art_id']
    ));?>" title="Artikel löschen">Löschen</a>
  </tr>
  <?php if (!empty($article['subpages'])): ?>
    <tr><td colspan="3"><small>Unterseiten:</small></td></tr>
    <?php foreach ($article['subpages'] as $subpage): ?>
    <tr class="subpage">
      <td><?php echo $subpage['desc']; ?></td>
      <td><?php echo substr(strip_tags($subpage['artcl']), 0, 200); ?></td>
      <td><a href="<?php echo $this->url(array(
    'action' => 'edit',
    'kid' => $this->consultation['kid'],
    'aid' => $subpage['art_id']
      ));?>">Bearbeiten</a>
      &nbsp;
      <a href="<?php echo $this->url(array(
    'action' => 'delete',
    'kid' => $this->consultation['kid'],
    'aid' => $subpage['art_id']
      ));?>" title="Artikel löschen">Löschen</a>
    </tr>
    <?php endforeach; ?>
  <?php endif; ?>
<?php endforeach;?>
</table>
<p><a href="<?php echo $this->url(array(
  'action' => 'create',
  'kid' => $this->consultation['kid']
));?>">Neuer Artikel</a></p>
