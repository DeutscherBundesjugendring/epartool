<?=$this->secondNavigation('voting');?>

<div class="main-content">
    <div class="row">
        <div class="sidebar-left hidden-print">

            <?=$this->questionNavigation($this->currentQuestion['qi']);?>

        </div>
        <div class="content">

            <h1 class="main-content-title-narrow"><?=$this->translate('Voting results')?></h1>

            <?php if (!empty($this->articleGeneral)) : ?>
                <?=html_entity_decode($this->articleGeneral['artcl'], ENT_COMPAT, 'UTF-8');?>
            <?php endif; ?>

            <?php if (!empty($this->articleConsultation)) : ?>
                <?=html_entity_decode($this->articleConsultation['artcl'], ENT_COMPAT, 'UTF-8');?>
            <?php endif; ?>

            <h2>
                <a href="<?=$this->url([
                    'controller' => 'input',
                    'action' => 'show',
                    'kid' => $this->currentQuestion['kid'],
                    'qid' => $this->currentQuestion['qi'],
                ]);?>">
                    <?=$this->currentQuestion['nr'];?>
                    <?=$this->currentQuestion['q'];?>
                </a>
            </h2>

            <hr class="hr-alt" />

            <?php foreach ($this->votings as $key => $value) : ?>
                <?php if ($value['uid']) : ?>
                    <a href="<?=$this->url([
                        'controller' => 'input',
                        'action' => 'show',
                        'kid' => $this->currentQuestion['kid'],
                        'qid' => $this->currentQuestion['qi'],
                    ]);?>">
                        <div class="result">
                            <span class="result-number"><?=$key + 1;?>.</span>
                            <p><strong><?=$value['thes'];?></strong></p>
                            <div
                                class="result-bar"
                                style="width:<?=$this->highest_rank
                                    ? round(($value['rank'] * 100) / $this->highest_rank, 0)
                                    : 0;
                                ?>%;"
                            ></div>
                            <span class="btn btn-default btn-sm">
                                <?=$this->translate('See contribution in context');?>
                            </span>
                        </div>
                    </a>
                <?php else : ?>
                    <div class="result">
                        <span class="result-number"><?=$key + 1;?>.</span>
                        <p><strong><?=$value['thes'];?></strong></p>
                        <div
                            class="result-bar"
                            style="width:<?=$this->highest_rank
                                ? round(($value['rank'] * 100) / $this->highest_rank, 0)
                                : 0;
                            ?>%;"
                        ></div>
                    </div>
                <?php endif;?>
                <hr />
            <?php endforeach; ?>

        </div>
    </div><!-- .row -->

    <?=$this->partial('_partials/pageLinks.phtml', ['help' => 'help-text-consultation-voting']);?>

</div><!-- .main-content -->
