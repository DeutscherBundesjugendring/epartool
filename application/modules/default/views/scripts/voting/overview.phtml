<?php echo $this->secondNavigation('voting') ?>

<div class="content-holder main-content">

    <h1 class="heading-centered"><?=$this->translate('Voting')?></h1>

    <div class="row">
		<section class="span9 offset1">

            <div class="well well-large text-center">
                <span class="label sticker label-mitmachen-black hidden-print">
                    <?=$this->translate('Join now!')?>
                </span>

                <!-- Voting counter -->
                <span class="counter counter-voting">
                    <?php
                        // Add leading zeros to count voted
                        $countTotal = $this->votableInputs;
                        $countVoted = $this->votedInputs;

                        if (strlen($countTotal) > strlen($countVoted)) {
                            $format = '%0' . strlen($countTotal) . 'd';
                            $countVoted = sprintf($format, $countVoted);
                        }

                        // Print count voted by number
                        $countVoted = str_split($countVoted);
                        $countVotedText = '';
                        foreach ($countVoted as $number) {
                            $countVotedText .= '<span class="counter-digit">' . $number . '</span>';
                        }
                    ?>
                    <br />
                    <?=sprintf($this->translate('You have voted on %s <br /> out of the total of %s contributions.'), $countVotedText, $countTotal)?>
                </span>

                <h2><?=$this->translate('Vote now!')?></h2>

                <!-- Questions -->
                <div class="offset-top-large">
                    <?php foreach ($this->questions as $question): ?>
                        <?php $url = $this->url(array('action' => 'vote', 'qid' => $question['qi'])); ?>
                        <p class="no-offset">
                            <a href="<?php echo $url ?>" class="btn"><?php echo $question['nr'] . ' ' . $question['q']; ?></a>
                        </p>
                    <?php endforeach; ?>
                </div>

                <p class="offset-top-large offset-bottom-large">
                    <?=$this->translate('Choose here the question or the keyword according to which the contributions to be voted will be shown first. You may change question or keyword any time. During the Voting, all contributions will be displayed, so that you will vote on all of them. You can edit as many contributions as you wish. Breaks or possible without any problems.')?>
                </p>

                <!-- Tags -->
                <h3><?=$this->translate('Contributions by topic')?></h3>
                <?php if (!empty($this->tags)): ?>
                    <ul class="tag-cloud tag-cloud-alt">
                        <?php foreach ($this->tags as $tag): ?>
                            <li class="tag-<?php echo $tag['frequency']; ?>">
                                <a href="<?php echo $this->url(array('action' => 'vote', 'tag' => $tag['tg_nr'], 'qid' => null)); ?>">
                                    <?php echo $tag['tg_de']; ?>
                                </a>
                            </li>
                        <?php endforeach; ?>
                    </ul>
                <?php endif; ?>

                <!-- Actions -->
                <p>
                    <a href="<?php echo $this->url(array('action' => 'stopvoting')); ?>" class="btn" title="Abstimmung beenden">
                        <i class="icon-signout"></i> <?=$this->translate('Finish')?>
                    </a>
                    <a href="<?php echo $this->url(array('action' => 'preview')); ?>" class="btn" title="Vorschau Abstimmung">
                        <i class="icon-eye-open"></i> <?=$this->translate('Preview voting')?>
                    </a>
                </p>

            </div><!-- .well -->

			<?php echo $this->render('_partials/printLink.phtml') ?>

		</section>
	</div><!-- .row -->
</div><!-- .content-holder -->

<?php echo $this->render('_partials/topLink.phtml') ?>
