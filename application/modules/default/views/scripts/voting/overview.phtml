<?php
/**
 * index
 *
 * @description   Startseite Abstimmung
 * @author        Markus Hackel, Jan Suchandt
 */
?>

<?php echo $this->secondNavigation('voting') ?>

<div class="content-holder main-content">

    <h1 class="heading-centered">Abstimmung</h1>

    <div class="row">
		<section class="span9 offset1">

            <div class="well well-large text-center">
                <span class="label sticker label-mitmachen-black hidden-print">Mitmachen!</span>

                <!-- Voting counter -->
                <span class="voting-counter">
                    Du hast schon über
                    <?php
                    // Add leading zeros to count voted
                    $countTotal = $this->votableInputs;
                    $countVoted = $this->votedInputs;

                    if (strlen($countTotal) > strlen($countVoted)) {
                        $format = '%0' . strlen($countTotal) . 'd';
                        $countVoted = sprintf($format, $countVoted);
                    }

                    // Print count voted by number
                    $countVoted = str_split($countVoted);
                    foreach ($countVoted as $number) {
                        echo '<span class="voting-counter-digit">' . $number . '</span>';
                    }
                    ?>
                    <br />
                    von insgesamt <?php echo $countTotal; ?> Beiträgen<br />
                    abgestimmt.
                </span>

                <h2>Stimme jetzt ab!</h2>

                <!-- Questions -->
                <div class="offset-top-large">
                    <?php foreach ($this->questions as $question): ?>
                        <?php $url = $this->url(array('action' => 'vote', 'qid' => $question['qi'])); ?>
                        <p class="no-offset">
                            <a href="<?php echo $url ?>" class="btn"><?php echo $question['nr'] . ' ' . $question['q']; ?></a>
                        </p>
                    <?php endforeach; ?>
                </div>

                <p class="offset-top-large offset-bottom-large">
                    Hier kannst du auswählen, zu welcher Frage oder zu welchem Schlagwort dir die Beiträge zum Abstimmen
                    zuerst angezeigt werden sollen. Ein Wechsel zwischen den verschiedenen Fragen und Begriffen ist
                    jederzeit möglich. Während der Abstimmung werden dir nach und nach alle Beiträge angezeigt, so dass
                    du auf jeden Fall über alle abstimmen kannst. Du kannst so viele Beiträge bearbeiten, wie du
                    möchtest. Unterbrechungen sind problemlos möglich.
                </p>

                <!-- Tags -->
                <h3>Beiträge nach Schlagwötern</h3>
                <?php if (!empty($this->tags)): ?>
                    <ul class="tag-cloud tag-cloud-alt">
                        <?php foreach ($this->tags as $tag): ?>
                            <li class="tag-<?php echo $tag['frequency']; ?>"><a href="<?php echo $this->url(array('action' => 'vote', 'tag' => $tag['tg_nr'], 'qid' => null)); ?>">
                            <?php echo $tag['tg_de']; ?></a></li>
                        <?php endforeach; ?>
                    </ul>
                <?php endif; ?>

                <!-- Actions -->
                <p>
                    <a href="<?php echo $this->url(array('action' => 'stopvoting')); ?>" class="btn" title="Abstimmung beenden">
                        <i class="icon-signout"></i> Beenden
                    </a>
                    <a href="<?php echo $this->url(array('action' => 'preview')); ?>" class="btn" title="Vorschau Abstimmung">
                        <i class="icon-eye-open"></i> Vorschau Abstimmung
                    </a>
                </p>

            </div><!-- .well -->

			<?php echo $this->render('_partials/printLink.phtml') ?>

		</section>
	</div><!-- .row -->
</div><!-- .content-holder -->

<?php echo $this->render('_partials/topLink.phtml') ?>
