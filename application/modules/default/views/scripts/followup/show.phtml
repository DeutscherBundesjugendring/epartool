<?php
/**
 * shows the initial timeline for followups by chosen input
 *
 * @description show Followup Timeline
 * @author Marco Dinnbier
 */
?>

<?php echo $this->secondNavigation('follow-up') ?>

<div class="content-holder">
    <section class="main-content">

        <div class="well well-large well-alt" id="followup">
            <div class="followuphead">
                <a href="<?php echo $this->url(array('action' => 'index', 'page' => null)) ?>" class="back-link" title="Zurück zur Übersicht Reaktionen & Wirkungen">
                    <div class="sprite question-mark"><p>?</p></div>
                    <h3 class="question-h3">Verfolge hier, welche Reaktionen es auf den Beitrag gab. Klicke auf die Pfeile für nächste Schritte.</h3>
                </a>
            </div>
            <h2 class="well-title text-center">Reaktionen & Wirkungen!</h2>
            <div class="wrapper">
                <div class="col">
                    <div class="timeline-box">
                        <h3>
                            <a
                                class="whitelink"
                                title="Zurück zur Übersicht der Beiträge sortiert nach Fragen"
                                href="<?php echo $this->url(array('action' => 'inputs-by-question', 'qid' => $this->question['qi'], 'page' => null)) ?>"
                            >
                                <?php echo $this->question['nr'] . ' ' . $this->question['q']; ?>
                            </a>
                        </h3>
                        <div class="content">
                            <p><?php echo $this->input['thes']; ?></p>
                            <?php if (!empty($this->input['expl'])): ?>
                                <div class="explbutton"><i class="icon-angle-down"></i></div>
                                <div class="toggleexpl">
                                    <p><?php echo $this->input['expl']; ?></p>
                                </div>

                            <?php endif; ?>
                            <?php if ($this->input['vot'] == 'y'): ?>
                                <p class="score">Ergebnis der Abstimmung: X. Rang</p>
                            <?php endif; ?>
                        </div>
                        <?php if ($this->relatedCount): ?>
                            <div class="timeline-countlink sprite">
                                <a class="ajaxclick reset"
                                   href="<?php echo $this->url(array('action' => 'show', 'tid' => $this->input['tid'], 'page' => null)) ?>/foreset/1"><?php echo $this->relatedCount; ?></a>
                                <!--<p><?php echo count($this->relInput); ?></p>-->
                            </div>
                        <?php endif; ?>
                    </div>
                </div>

                <div class="col">
                    <?php if (count($this->relInput)): ?>
                        <?php foreach ($this->relInput as $relInput): ?>
                            <div class="timeline-box">
                                <div class="content">
                                    <p><?php echo $relInput['thes']; ?></p>
                                    <?php if ($relInput['vot'] == 'y'): ?>
                                        <p class="score">Ergebnis der Abstimmung: X. Rang</p>
                                    <?php endif?>
                                </div>
                                <?php if ($relInput['relFowupCount'] != 0): ?>
                                    <div class="timeline-countlink sprite">
                                        <a class="ajaxclick"
                                           href="<?php echo $this->url(array('action' => 'json', 'tid' => $relInput['tid'], 'page' => null)) ?>"><?php echo $relInput['relFowupCount']; ?></a>
                                    </div>
                                <?php endif; ?>
                            </div>
                        <?php endforeach; ?>
                    <?php endif; ?>
                    <?php if (count($this->relSnippets)): ?>
                        <?php foreach ($this->relSnippets as $snippet): ?>

                            <?php echo $this->snippetBox($snippet) ?>

                        <?php endforeach; ?>
                    <?php endif; ?>
                </div>
            </div>

            <div id="followuploader">Loading…</div>
        </div>

    </section>
</div><!-- .content-holder -->

<script type="text/javascript">
    $(document).ready(function() {
        /**
         * instance of followup created
         * @type {FollowUp}
         */
        var followUp = new FollowUp(<?php echo $this->input['kid']; ?>);
    });
</script>
